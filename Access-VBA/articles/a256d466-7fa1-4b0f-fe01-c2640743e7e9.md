
# ODBCError Object (Excel)

 **Last modified:** July 28, 2015

Represents an ODBC error generated by the most recent ODBC query.

## Remarks

 The **ODBCError** object is a member of the ** [ODBCErrors](2f1c8a6b-2b9d-fc2c-7caa-289652ac8e24.md)** collection. If the specified ODBC query runs without error, the **ODBCErrors** collection is empty. The errors in the collection are indexed in the order in which they're generated by the ODBC data source.


## Example

Use  ** [ODBCErrors](47caef7a-fd3c-f67f-09c1-5ac21d65b67f.md)**( _index_), where  _index_ is the index number of the error, to return a single **ODBCError** object. The following example refreshes query table one and displays the first ODBC error that occurs.


```
With Worksheets(1).QueryTables(1) 
 .Refresh 
 If Application.ODBCErrors.Count > 0 Then 
 Set er = Application.ODBCErrors(1) 
 MsgBox "The following error occurred:" &amp; 
 er.ErrorString &amp; " : " &amp; er.SqlState 
 Else 
 MsgBox "Query complete: all records returned." 
 End If 
End With
```


## See also


#### Concepts


 [Excel Object Model Reference](11ea8598-8a20-92d5-f98b-0da04263bf2c.md)
#### Other resources


 [ODBCError Object Members](d2dc90a0-5f7e-1e2e-6fdf-307b3ed42fec.md)
