
# Managing Rules in the Outlook Object Model

 **Last modified:** July 28, 2015

The  **Rules** object model supports the programmatic adding, editing, and deleting of rules. The ** [Rule](ea2ddbcc-fd65-a636-c6da-79950033f385.md)** and ** [Rules](dd41b4de-bf5f-5532-46c9-394a5d078bec.md)** collection objects allow you to access, add, and delete rules defined for a session. The ** [RuleAction](6451788f-e5ed-239c-a34d-b564b52d8955.md)** and ** [RuleCondition](e03f91c2-2c08-b036-104a-d6246f28bc2d.md)** objects, their collection objects, and derived action and condition objects further support editing actions and conditions.

 **Note**  The  **Rules** object model provides partial parity with the **Rules and Alerts Wizard** in the Outlook user interface. Although it does not support every single rule that you can possibly create using the Wizard, it supports the most commonly used rule actions and conditions. Just like any rule created by using the **Rules and Alerts** Wizard, rules created programmatically are applied to messages, which include mail items, meeting requests, task requests, documents, delivery receipts, read receipts, voting responses, and out-of-office notices.

Use  ** [Store.GetRules](06048799-e162-68f9-17c2-d80c25e2c55e.md)** to obtain a **Rules** collection object representing the rules defined for the store used in the current session.
After obtaining the set of rules for the current session, you can then add new rules (by using  ** [Rules.Create](84789ccc-a6c2-9f79-5338-45b03b116dd5.md)**), edit existing rules (by enabling or disabling rules, changing their execution order, and modifying rule actions and rule conditions), or delete rules (by using  ** [Rules.Remove](6d4bb971-b38a-0434-1b6a-8892689549d6.md)**) from this  **Rules** collection. Note that while you can edit rules created in versions of Outlook before Microsoft Office Outlook 2007, you cannot use earlier versions of Outlook to edit rules that have been created in Office Outlook 2007 or later.
You can retrieve each rule in a  **Rules** collection by indexing the collection using ** [Rules.Item(Index)](fe696181-9f61-0eb7-9634-5f7c007f1606.md)**, with  _Index_ being either the name of the rule (the default property ** [Rule.Name](6c559ffe-b25c-ff49-31d1-1fd44935a8f3.md)**), or a value ranging from 1 through the total number of rules in the collection,  ** [Rules.Count](b1753709-5693-9f2a-cd11-0e3c4e5e0982.md)**.  ** [Rule.ExecutionOrder](070d50ca-4b0b-5629-1609-81ab8a3620d1.md)** indicates the order of execution of the rules in the collection and is directly mapped with the numerical value of _Index_ in **Rules.Items(Index)**. For example,  `Rules.Item(1)` represents a rule with **Rule.ExecutionOrder** being 1, `Rules.Item(2)` represents a rule with **Rule.ExecutionOrder** being 2, and `Rules.Item(Rules.Count)` represents the rule with **Rule.ExecutionOrder** being **Rules.Count**.
After you have defined a rule, you should also enable it by setting the  ** [Rule.Enabled](9ba65f87-799f-7a22-04a1-c0abcb320559.md)** property to **True**, and then save the rule by using  ** [Rules.Save](d838eca0-4ec5-ab43-a031-fd65ab7d9f3c.md)** so that the rule and its enabled state will persist beyond the current session. A rule is only enabled after it has been saved successfully. Note that **Rules.Save** can be an expensive operation in terms of performance on slow connections to Exchange server; you can optionally display a progress dialog box for the user to cancel the operation. A save fails when the user edits the same rule in the Rules and Alerts Wizard, or the user cancels the progress dialog box. In such cases, **Rules.Save** will raise an error, and the user will resolve the conflict by responding to the error dialog brought up by the Rules and Alerts Wizard.
When you use  **Rules.Save** to save one or more rules that have been created in Office Outlook 2007, you will be prompted with a dialog to remind you that you will not be able to edit that rule using earlier versions of Outlook. You will have to confirm the dialog before the save opreation can proceed.
Use  ** [Rule.Execute](487abb6f-9003-04a4-f4e2-3f66b3ba5a52.md)** to run a rule. Note that while you must enable and save a rule to have it enabled beyond the current session, you can run the rule regardless of its enabled state. When you execute a rule, you can optionally specify the folder to apply to rule to. The default is to execute the rule against all messages in the Inbox, but not subfolders of the Inbox.
